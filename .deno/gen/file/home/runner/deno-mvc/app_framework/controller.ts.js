import { Static } from "./util/static.ts";
export const SUCCESS = { status: 200, headers: { "Content-Type": "text/html" } };
export const SUCCESS_JSON = { status: 200, headers: { "Content-Type": "application/json" } };
export class Controller {
    routes;
    constructor(routes = {}) {
        this.routes = routes;
    }
    add(key, callback) {
        this.routes[key] = callback;
    }
    async route(key, r) {
        let path = key.split("?")[0];
        path = path !== "/" ? path : "/index.html";
        const full_key = r.method + " " + path;
        if (this.routes.hasOwnProperty(full_key)) {
            return await this.routes[full_key](r);
        }
        const response = (new Static("./static")).read(path);
        if (response != undefined) {
            return response;
        }
        return { body: "404 Not Found", head: { status: 404, headers: { "Content-Type": "text/html" } } };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRTFDLE1BQU0sQ0FBQyxNQUFNLE9BQU8sR0FBRyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUMsY0FBYyxFQUFFLFdBQVcsRUFBRSxFQUFDLENBQUM7QUFDOUUsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBQyxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsRUFBQyxDQUFDO0FBc0IxRixNQUFNLE9BQU8sVUFBVTtJQUVyQixNQUFNLENBQVE7SUFFZCxZQUFZLFNBQWMsRUFBRTtRQUMxQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsR0FBRyxDQUFDLEdBQVUsRUFBRSxRQUFpQjtRQUMvQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLFFBQVEsQ0FBQztJQUM5QixDQUFDO0lBRUQsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFVLEVBQUUsQ0FBZTtRQUNyQyxJQUFJLElBQUksR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdCLElBQUksR0FBRyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQztRQUMzQyxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7UUFHdkMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsRUFBQztZQUN2QyxPQUFPLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN2QztRQUVELE1BQU0sUUFBUSxHQUFHLENBQUMsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsSUFBRyxRQUFRLElBQUksU0FBUyxFQUFDO1lBQ3ZCLE9BQU8sUUFBUSxDQUFDO1NBQ2pCO1FBRUQsT0FBTyxFQUFDLElBQUksRUFBQyxlQUFlLEVBQUUsSUFBSSxFQUFDLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBQyxjQUFjLEVBQUUsV0FBVyxFQUFFLEVBQUMsRUFBQyxDQUFBO0lBQzVGLENBQUM7Q0FFRiJ9
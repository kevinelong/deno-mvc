import { Model } from "./mvc/model.ts";
import { View } from "./mvc/view.ts";
import { Controller } from "./mvc/controller.ts";
const messages_model = new Model("demo.db", "messages", [
    { field_name: "id", field_type: "INTEGER PRIMARY KEY AUTOINCREMENT" },
    { field_name: "email", field_type: "text" },
    { field_name: "message_text", field_type: "text" },
    { field_name: "time_created", field_type: "DATETIME DEFAULT CURRENT_TIMESTAMP" },
]);
messages_model.create({ email: "kevinelong@gmail.com", message_text: "Greetings and Salutations!" });
messages_model.create({ email: "dude@example.com", message_text: "Wassup!?" });
const message_view = new View("<h1>{ message_text }</h1>\n<b>{ email }</b> <i>{ time_created }</i>");
const show_message = (d) => message_view.get(d);
export const routes = new Controller();
const SUCCESS = { status: 200, headers: { "Content-Type": "text/html" } };
const SUCCESS_JSON = { status: 200, headers: { "Content-Type": "application/json" } };
function validate(e) {
    let destination = "/chat.html";
    return { body: ``, head: { status: 302, headers: { Location: destination } } };
}
routes.add("POST /validate/", validate);
function messages_view(e) {
    return { body: messages_model.read().map(show_message).join("\n\n"), head: SUCCESS };
}
routes.add("GET /messages_view/", validate);
function api_messages(e) {
    return { body: JSON.stringify(messages_model.read()), head: SUCCESS_JSON };
}
routes.add("GET /api/v1/messages/", api_messages);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicm91dGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQWFqRCxNQUFNLGNBQWMsR0FBSSxJQUFJLEtBQUssQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFO0lBQ3ZELEVBQUMsVUFBVSxFQUFDLElBQUksRUFBRSxVQUFVLEVBQUMsbUNBQW1DLEVBQUM7SUFDakUsRUFBQyxVQUFVLEVBQUMsT0FBTyxFQUFFLFVBQVUsRUFBQyxNQUFNLEVBQUM7SUFDdkMsRUFBQyxVQUFVLEVBQUMsY0FBYyxFQUFFLFVBQVUsRUFBQyxNQUFNLEVBQUM7SUFDOUMsRUFBQyxVQUFVLEVBQUMsY0FBYyxFQUFFLFVBQVUsRUFBQyxvQ0FBb0MsRUFBQztDQUM3RSxDQUFDLENBQUM7QUFFSCxjQUFjLENBQUMsTUFBTSxDQUFDLEVBQUMsS0FBSyxFQUFDLHNCQUFzQixFQUFFLFlBQVksRUFBQyw0QkFBNEIsRUFBQyxDQUFDLENBQUM7QUFDakcsY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFDLEtBQUssRUFBQyxrQkFBa0IsRUFBRSxZQUFZLEVBQUMsVUFBVSxFQUFDLENBQUMsQ0FBQztBQUszRSxNQUFNLFlBQVksR0FBRyxJQUFJLElBQUksQ0FBQyxxRUFBcUUsQ0FBQyxDQUFDO0FBQ3JHLE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBUSxFQUFDLEVBQUUsQ0FBQSxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBSXJELE1BQU0sQ0FBQyxNQUFNLE1BQU0sR0FBRyxJQUFJLFVBQVUsRUFBRSxDQUFDO0FBRXZDLE1BQU0sT0FBTyxHQUFHLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBQyxjQUFjLEVBQUUsV0FBVyxFQUFFLEVBQUMsQ0FBQztBQUN2RSxNQUFNLFlBQVksR0FBRyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUMsY0FBYyxFQUFFLGtCQUFrQixFQUFFLEVBQUMsQ0FBQztBQUVuRixTQUFTLFFBQVEsQ0FBQyxDQUFlO0lBQy9CLElBQUksV0FBVyxHQUFHLFlBQVksQ0FBQztJQUUvQixPQUFPLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxNQUFNLEVBQUMsR0FBRyxFQUFFLE9BQU8sRUFBQyxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsRUFBRSxFQUFFLENBQUM7QUFDL0UsQ0FBQztBQUNELE1BQU0sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFFeEMsU0FBUyxhQUFhLENBQUMsQ0FBZTtJQUNwQyxPQUFPLEVBQUMsSUFBSSxFQUFFLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQztBQUN0RixDQUFDO0FBQ0QsTUFBTSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxRQUFRLENBQUMsQ0FBQztBQUU1QyxTQUFTLFlBQVksQ0FBQyxDQUFlO0lBQ25DLE9BQU0sRUFBQyxJQUFJLEVBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUMsWUFBWSxFQUFDLENBQUM7QUFDeEUsQ0FBQztBQUNELE1BQU0sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLEVBQUUsWUFBWSxDQUFDLENBQUMifQ==